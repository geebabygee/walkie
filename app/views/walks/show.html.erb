<%= render 'shared/jumbotron' %>
<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <div class="d-inline categories">

       <h3><%= @walk.category.name%></h3>
       <h3>
        <strong> <%=@walk.name %></strong>
      </h3>
      <hr>
      <%= @walk.duration %>
      <i class="far fa-clock"></i>

      <%= @walk.location%>
      <hr>
      <p>
        <%= @walk.description %>
        <br>
      </p>

    </div>

    <div class="fullwidth">

      <div class="timeline group">

        <div class="item">
          <h4>Point of Interest 1</h4>
          <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo.</p>
        </div>

        <div class="item">
          <h4>Point of Interest 2</h4>
          <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes.</p>
        </div>

        <div class="item">
          <h4>Point of Interest 3 </h4>
          <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo.</p>
        </div>

        <div class="item">
          <h4>Point of Interest 4 </h4>
          <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. </p>
        </div>

        <div class="item">
          <h4> Point of Interest 5</h4>
          <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo.</p>
        </div>

        <div class="item">
          <h4>Point of Interest</h4>
          <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. </p>
        </div>

      </div>

    </div>

    <div>
      <div>
        <h3><strong>Reviews</strong></h3>

        <% @reviews.each  do |review| %>
        <div class="message">
          <img class="avatar-large" src="https://kitt.lewagon.com/placeholder/users/joemonteiro">
          <div class="message-body">
            "<%= review.content %>"
          </div>
        </div>
        <% end %>
      </div>
    </div>
    <div id='map' style='width: 400px; height: 300px;'></div>
  <script>
    points = <%= raw @walk.points.to_json %>;

    mapboxgl.accessToken = 'pk.eyJ1IjoiZnJhbmNpc2NvYmFycmV0byIsImEiOiJjamVoMWRjMjMwbWh6MnFuczF6dGd6bmFoIn0.S5h45dvXuYQ3xoN-d504KA'; // replace this with your access token
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v10', // replace this with your style
      center: [points[0].longitude, points[0].latitude],
      zoom: 13
    });


    // Add zoom and rotation controls to the map.
    map.addControl(new mapboxgl.NavigationControl());

    map.on('load', function () {

        map.addLayer({
            "id": "route",
            "type": "line",
            "source": {
                "type": "geojson",
                "data": {
                    "type": "Feature",
                    "properties": {},
                    "geometry": {
                        "type": "LineString",
                        "coordinates": [
                            // for each points print [longitude,latitude]
                            points.forEach((point) => {
                              let coordinates = [point.longitude, point.latitude]
                              console.log(coordinates)
                            });
                        ]
                    }
                }
            },
            "layout": {
                "line-join": "round",
                "line-cap": "round"
            },
            "paint": {
                "line-color": "#888",
                "line-width": 8
            }
        });
    });

    // code from the next step will go here
    // map.on('click', function(e) {
    //   var features = map.queryRenderedFeatures(e.point, {
    //     layers: ['{layer_name}'] // replace this with the name of the layer
    //   });
    //   if (!features.length) {
    //     return;
    //   }
    //   var feature = features[0];
    //   var popup = new mapboxgl.Popup({ offset: [0, -15] })
    //   .setLngLat(feature.geometry.coordinates)
    //   .setHTML('<h3>' + feature.properties.title + '</h3><p>' + feature.properties.description + '</p>')
    //   .setLngLat(feature.geometry.coordinates)
    //   .addTo(map);
    // });
  </script>
  </div>


